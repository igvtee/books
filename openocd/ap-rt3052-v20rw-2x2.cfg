#
# Configuration file for Ralink RT3052
#

source [find interface/ftdi/dp_busblaster.cfg]

transport select jtag
reset_config trst_and_srst
adapter speed 2000
#adapter_khz 2000
#jtag_ntrst_delay 200
#adapter srst delay 100
#jtag_nsrst_delay 100

if { [info exists CHIPNAME] } {
	set _CHIPNAME $CHIPNAME
} else {
	set _CHIPNAME rt3052
}
set _TARGETNAME $_CHIPNAME.cpu
set _ENDIAN little

# DAP (Debug Access Port)
if { [info exists DAP_TAPID] } {
	set _DAP_TAPID $DAP_TAPID
} else {
	set _DAP_TAPID 0x1305224f
}

# Declare a JTAG tap (Test Access Ports) to access the DAP
jtag newtap $_CHIPNAME cpu -irlen 5 -expected-id $_DAP_TAPID

# Target
target create $_TARGETNAME mips_m4k -endian $_ENDIAN -chain-position $_TARGETNAME

# setup working area in RAM 32MB (16MB W9812G6IH-6 16bits * 2) (max 64MB)
$_TARGETNAME configure \
		-work-area-phys 0x00000000 \
		-work-area-size 0x02000000 \
		-work-area-backup 0

# nor flash size 4MB MX29LV320C 16bits (max 16MB)
flash bank $_CHIPNAME.flash cfi 0x1f000000 0x00400000 2 2 $_TARGETNAME

set partition_list {
    uboot       { Bootloader                    0x1f000000 0x00030000 }
    ubootenv    { "Config space"                0x1f030000 0x00010000 }
    factory     { "ART space"                   0x1f040000 0x00010000 }
    firmware    { "Kernel+rootfs"               0x1f050000 0x003b0000 }
}

